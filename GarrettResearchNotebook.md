# Online Dissertation Research Notebook

## Author: April Dawn Garrett
#### Affiliation: University of Vermont, Biology Department, Pespeni Lab 

## Projects title/descriptions

## Date started: 03/25/2018 
## Date end:  


# Table of contents (for 200 entries)    
* [Page 1:   2018-04-04](#id-section1) Urchin Capseq MS BWA Mem ReMapping Notes
* [Page 2:  ](#id-section2) Carbonic Anhydrase: Getting Allele Freqs From Files Melissa Mapped
* [Page 3:  ](#id-section3).
* [Page 4:  ](#id-section4).
* [Page 5:  ](#id-section5).
* [Page 6:  ](#id-section6).
* [Page 7:  ](#id-section7).
* [Page 8:  ](#id-section8).
* [Page 9:  ](#id-section9).
* [Page 10:  ](#id-section10).
* [Page 11:  ](#id-section11).
* [Page 12:  ](#id-section12).
* [Page 13:  ](#id-section13).
* [Page 14:  ](#id-section14).
* [Page 15:  ](#id-section15).
* [Page 16:  ](#id-section16).
* [Page 17:  ](#id-section17).
* [Page 18:  ](#id-section18).
* [Page 19:  ](#id-section19).
* [Page 20:  ](#id-section20).
* [Page 21:  ](#id-section21).
* [Page 22:  ](#id-section22).
* [Page 23:  ](#id-section23).
* [Page 24:  ](#id-section24).
* [Page 25:  ](#id-section25).
* [Page 26:  ](#id-section26).
* [Page 27:  ](#id-section27).
* [Page 28:  ](#id-section28).
* [Page 29:  ](#id-section29).
* [Page 30:  ](#id-section30).
* [Page 31:  ](#id-section31).
* [Page 32:  ](#id-section32).
* [Page 33:  ](#id-section33).
* [Page 34:  ](#id-section34).
* [Page 35:  ](#id-section35).
* [Page 36:  ](#id-section36).
* [Page 37:  ](#id-section37).
* [Page 38:  ](#id-section38).
* [Page 39:  ](#id-section39).
* [Page 40:  ](#id-section40).
* [Page 41:  ](#id-section41).
* [Page 42:  ](#id-section42).
* [Page 43:  ](#id-section43).
* [Page 44:  ](#id-section44).
* [Page 45:  ](#id-section45).
* [Page 46:  ](#id-section46).
* [Page 47:  ](#id-section47).
* [Page 48:  ](#id-section48).
* [Page 49:  ](#id-section49).
* [Page 50:  ](#id-section50).
* [Page 51:  ](#id-section51).
* [Page 52:  ](#id-section52).
* [Page 53:  ](#id-section53).
* [Page 54:  ](#id-section54).
* [Page 55:  ](#id-section55).
* [Page 56:  ](#id-section56).
* [Page 57:  ](#id-section57).
* [Page 58:  ](#id-section58).
* [Page 59:  ](#id-section59).
* [Page 60:  ](#id-section60).
* [Page 61:  ](#id-section61).
* [Page 62:  ](#id-section62).
* [Page 63:  ](#id-section63).
* [Page 64:  ](#id-section64).
* [Page 65:  ](#id-section65).
* [Page 66:  ](#id-section66).
* [Page 67:  ](#id-section67).
* [Page 68:  ](#id-section68).
* [Page 69:  ](#id-section69).
* [Page 70:  ](#id-section70).
* [Page 71:  ](#id-section71).
* [Page 72:  ](#id-section72).
* [Page 73:  ](#id-section73).
* [Page 74:  ](#id-section74).
* [Page 75:  ](#id-section75).
* [Page 76:  ](#id-section76).
* [Page 77:  ](#id-section77).
* [Page 78:  ](#id-section78).
* [Page 79:  ](#id-section79).
* [Page 80:  ](#id-section80).
* [Page 81:  ](#id-section81).
* [Page 82:  ](#id-section82).
* [Page 83:  ](#id-section83).
* [Page 84:  ](#id-section84).
* [Page 85:  ](#id-section85).
* [Page 86:  ](#id-section86).
* [Page 87:  ](#id-section87).
* [Page 88:  ](#id-section88).
* [Page 89:  ](#id-section89).
* [Page 90:  ](#id-section90).
* [Page 91:  ](#id-section91).
* [Page 92:  ](#id-section92).
* [Page 93:  ](#id-section93).
* [Page 94:  ](#id-section94).
* [Page 95:  ](#id-section95).
* [Page 96:  ](#id-section96).
* [Page 97:  ](#id-section97).
* [Page 98:  ](#id-section98).
* [Page 99:  ](#id-section99).
* [Page 100:  ](#id-section100).
* [Page 101:  ](#id-section101).
* [Page 102:  ](#id-section102).
* [Page 103:  ](#id-section103).
* [Page 104:  ](#id-section104).
* [Page 105:  ](#id-section105).
* [Page 106:  ](#id-section106).
* [Page 107:  ](#id-section107).
* [Page 108:  ](#id-section108).
* [Page 109:  ](#id-section109).
* [Page 110:  ](#id-section110).
* [Page 111:  ](#id-section111).
* [Page 112:  ](#id-section112).
* [Page 113:  ](#id-section113).
* [Page 114:  ](#id-section114).
* [Page 115:  ](#id-section115).
* [Page 116:  ](#id-section116).
* [Page 117:  ](#id-section117).
* [Page 118:  ](#id-section118).
* [Page 119:  ](#id-section119).
* [Page 120:  ](#id-section120).
* [Page 121:  ](#id-section121).
* [Page 122:  ](#id-section122).
* [Page 123:  ](#id-section123).
* [Page 124:  ](#id-section124).
* [Page 125:  ](#id-section125).
* [Page 126:  ](#id-section126).
* [Page 127:  ](#id-section127).
* [Page 128:  ](#id-section128).
* [Page 129:  ](#id-section129).
* [Page 130:  ](#id-section130).
* [Page 131:  ](#id-section131).
* [Page 132:  ](#id-section132).
* [Page 133:  ](#id-section133).
* [Page 134:  ](#id-section134).
* [Page 135:  ](#id-section135).
* [Page 136:  ](#id-section136).
* [Page 137:  ](#id-section137).
* [Page 138:  ](#id-section138).
* [Page 139:  ](#id-section139).
* [Page 140:  ](#id-section140).
* [Page 141:  ](#id-section141).
* [Page 142:  ](#id-section142).
* [Page 143:  ](#id-section143).
* [Page 144:  ](#id-section144).
* [Page 145:  ](#id-section145).
* [Page 146:  ](#id-section146).
* [Page 147:  ](#id-section147).
* [Page 148:  ](#id-section148).
* [Page 149:  ](#id-section149).
* [Page 150:  ](#id-section150).
* [Page 151:  ](#id-section151).
* [Page 152:  ](#id-section152).
* [Page 153:  ](#id-section153).
* [Page 154:  ](#id-section154).
* [Page 155:  ](#id-section155).
* [Page 156:  ](#id-section156).
* [Page 157:  ](#id-section157).
* [Page 158:  ](#id-section158).
* [Page 159:  ](#id-section159).
* [Page 160:  ](#id-section160).
* [Page 161:  ](#id-section161).
* [Page 162:  ](#id-section162).
* [Page 163:  ](#id-section163).
* [Page 164:  ](#id-section164).
* [Page 165:  ](#id-section165).
* [Page 166:  ](#id-section166).
* [Page 167:  ](#id-section167).
* [Page 168:  ](#id-section168).
* [Page 169:  ](#id-section169).
* [Page 170:  ](#id-section170).
* [Page 171:  ](#id-section171).
* [Page 172:  ](#id-section172).
* [Page 173:  ](#id-section173).
* [Page 174:  ](#id-section174).
* [Page 175:  ](#id-section175).
* [Page 176:  ](#id-section176).
* [Page 177:  ](#id-section177).
* [Page 178:  ](#id-section178).
* [Page 179:  ](#id-section179).
* [Page 180:  ](#id-section180).
* [Page 181:  ](#id-section181).
* [Page 182:  ](#id-section182).
* [Page 183:  ](#id-section183).
* [Page 184:  ](#id-section184).
* [Page 185:  ](#id-section185).
* [Page 186:  ](#id-section186).
* [Page 187:  ](#id-section187).
* [Page 188:  ](#id-section188).
* [Page 189:  ](#id-section189).
* [Page 190:  ](#id-section190).
* [Page 191:  ](#id-section191).
* [Page 192:  ](#id-section192).
* [Page 193:  ](#id-section193).
* [Page 194:  ](#id-section194).
* [Page 195:  ](#id-section195).
* [Page 196:  ](#id-section196).
* [Page 197:  ](#id-section197).
* [Page 198:  ](#id-section198).
* [Page 199:  ](#id-section199).
* [Page 200:  ](#id-section200).


------

<div id='id-section1'/>    
    
### Page 1:  Urchin Capseq MS BWA Mem ReMapping Notes     


### April 4, 2018: Carbonic Anhydrase work. Adding read groups to bam files via picard tools and remaking vcf file for Melissa

java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=CC_SH_H_D1_0385.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/CC_SH_H_D1_0385.fastq.WithRG.bam \
      RGID=CC_SH_H_D1_0385 \
      RGLB=CC_SH_H_D1_0385 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=CC_SH_H_D1_0385
      
# Check to see that it read group was added     
/data/programs/samtools view -H CC_SH_H_D1_0385.fastq.WithRG.bam | grep "^@RG" > RG_CC_SH_H_D1_0385.txt

# Now do for all files (BELOW)

java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=CC_SH_H_D7_1000.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/CC_SH_H_D7_1000.fastq.WithRG.bam \
      RGID=CC_SH_H_D7_1000 \
      RGLB=CC_SH_H_D7_1000 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=CC_SH_H_D7_1000
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=CC_TP_L_D1_0385.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/CC_TP_L_D1_0385.fastq.WithRG.bam \
      RGID=CC_TP_L_D1_0385 \
      RGLB=CC_TP_L_D1_0385 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=CC_TP_L_D1_0385
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=CC_TP_L_D7_1000.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/CC_TP_L_D7_1000.fastq.WithRG.bam \
      RGID=CC_TP_L_D7_1000 \
      RGLB=CC_TP_L_D7_1000 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=CC_TP_L_D7_1000
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=NC_BD_L_D1_0385.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/NC_BD_L_D1_0385.fastq.WithRG.bam \
      RGID=NC_BD_L_D1_0385 \
      RGLB=NC_BD_L_D1_0385 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=NC_BD_L_D1_0385
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=NC_BD_L_D7_1000.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/NC_BD_L_D7_1000.fastq.WithRG.bam \
      RGID=NC_BD_L_D7_1000 \
      RGLB=NC_BD_L_D7_1000 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=NC_BD_L_D7_1000
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=NC_VD_H_D1_0385.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/NC_VD_H_D1_0385.fastq.WithRG.bam \
      RGID=NC_VD_H_D1_0385 \
      RGLB=NC_VD_H_D1_0385 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=NC_VD_H_D1_0385
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=NC_VD_H_D7_1000.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/NC_VD_H_D7_1000.fastq.WithRG.bam \
      RGID=NC_VD_H_D7_1000 \
      RGLB=NC_VD_H_D7_1000 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=NC_VD_H_D7_1000
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=OR_FC_L_D1_0385.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/OR_FC_L_D1_0385.fastq.WithRG.bam \
      RGID=OR_FC_L_D1_0385 \
      RGLB=OR_FC_L_D1_0385 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=OR_FC_L_D1_0385
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=OR_FC_L_D7_1000.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/OR_FC_L_D7_1000.fastq.WithRG.bam \
      RGID=OR_FC_L_D7_1000 \
      RGLB=OR_FC_L_D7_1000 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=OR_FC_L_D7_1000
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=OR_ST_H_D1_0385.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/OR_ST_H_D1_0385.fastq.WithRG.bam \
      RGID=OR_ST_H_D1_0385 \
      RGLB=OR_ST_H_D1_0385 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=OR_ST_H_D1_0385
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=OR_ST_H_D7_1002.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/OR_ST_H_D7_1002.fastq.WithRG.bam \
      RGID=OR_ST_H_D7_1002 \
      RGLB=OR_ST_H_D7_1002 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=OR_ST_H_D7_1002
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=SB_AL_L_D1_0385.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/SB_AL_L_D1_0385.fastq.WithRG.bam \
      RGID=SB_AL_L_D1_0385 \
      RGLB=SB_AL_L_D1_0385 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=SB_AL_L_D1_0385
      
java -jar /data/programs/picard.jar AddOrReplaceReadGroups \
      I=SB_AL_L_D7_1000.fastq.gz.bam \
      O=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/SB_AL_L_D7_1000.fastq.WithRG.bam \
      RGID=SB_AL_L_D7_1000 \
      RGLB=SB_AL_L_D7_1000 \
      RGPL=Illumina \
      RGPU=NA \
      RGSM=SB_AL_L_D7_1000
      
#######################################################################################################################
      
### MAKING VCF File



# Merge all the bam files into one
/data/programs/samtools merge merged.bam *.bam

## Making bash script for sorting and indexing merged bam file and making vcf file

#!/bin/bash

# NOTE: Need to specify a different tmp directory or it will fill the rhel-root...
/data/programs/sambamba_v0.6.0 sort -m 8G -t 8 -p --tmpdir=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/data/tmp merged.bam merged.sorted.bam

# Remove PCR duplicates (same as Picard tools)

/data/programs/sambamba_v0.6.0 markdup -t 8 -r --tmpdir=/users/a/m/amakukho/RESEARCH/CarbonicAnhydrase/data/tmp merged.sorted.bam merged.sorted.rmdup.bam

# Run samtools index (with original samtools, not version 019)

/data/programs/samtools index merged.sorted.rmdup.bam

# Making VCF file with samtools version 1.4 # Removing skip-indels
/data/programs/samtools-1.4.1/samtools mpileup -u -t DP,AD,INFO/AD -f /data/urchinadult/carbonic_anhydrase_nt.fa merged.sorted.rmdup.bam | /data/programs/bcftools/bin/bcftools bcftools call -mv  > CarbonicAnhydrase_urchinlarvae2013.vcf

#######################################################################################################################



